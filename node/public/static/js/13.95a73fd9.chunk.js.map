{"version":3,"sources":["components/login/SignUpForm.tsx","components/login/LoginForm.tsx","components/profile/ChangePassword.tsx","components/profile/MyProfile.tsx","pages/Profile.tsx","hooks.tsx","utils.ts","callers/userCaller.ts","../../../../../webpack/universalModuleDefinition","../../../../../index.js","../webpack:/webpack/bootstrap 5c04cbde4fb824613eb6","../../../../../src/Compress.js","../../../../../src/core/base64.js","../../../../../src/core/converter.js","../../../../../src/core/file.js","../../../../../src/core/image.js","../../../../../src/core/photo.js","../../../../../src/core/rotate.js","components/profile/FollowedUserRow.tsx","components/profile/FollowedUsers.tsx","components/profile/FollowingUsers.tsx"],"names":["SignUpForm","useState","userTakenMsg","setUserTakenMsg","msg","setMsg","useBinder","userName","nickName","password","permission","newUser","bindNewUser","pw2","useRef","checkCommand","a","doesExist","doesExistResponse","status","json","exists","length","current","value","console","log","sendSignUpRequest","insertAuthUser","className","onChange","name","placeholder","onClick","type","ref","LoginForm","setPermissionlevel","autoLogin","messenger","React","useContext","MessageContext","signUpLine","setSignUp","signUpForm","history","useHistory","login","undefined","checked","loggedInUser","push","addSuccess","addWarning","action","ChangePassword","oldPw","setOldPw","newPw1","setNewPw1","newPw2","setNewPw2","updatePasswordCommand","clearInput","updatePassword","localStorage","getItem","clear","addFail","useEffect","e","target","onKeyDown","onEnter","MyProfile","about","myProfile","setMyProfile","bindMyProfile","imageFile","useImage","imgsrc","onImgError","setImgsrc","logOut","window","location","reload","updateUserInfoCommand","updateUserInfo","selectDetailedUser","profile","formData","FormData","files","resizeImageFn","resizedFile","append","uploadAvatar","Date","getTime","getMyInfo","src","onError","alt","title","accept","key","rows","Login","setPermissionLevel","document","FollowedUsers","FollowingUsers","ESize","useAsyncReference","forceRender","newState","Object","is","s","get","set","event","useAsyncBinder","updateState","useCutter","defaultText","defaultCutPos","getCutText","firstText","firstCut","isCut","setIsCut","outputText","setOutputText","cut","text","cutPos","newText","didCut","toCut","substring","callback","useScroll","pos","newPos","position","listener","innerHeight","scrollY","body","offsetHeight","addEventListener","removeEventListener","path","fileName","size","Normal","tryAgain","imgSrc","setImgSrc","tryAgainRef","imgSrcSetter","newPath","newFileName","replacedList","array","oldItem","newItem","map","item","file","maxWidth","maxHeight","quality","Compress","require","compress","resize","resizedImage","img","base64str","data","imgExt","ext","resizedFiile","convertBase64ToFile","userPath","selectFollowers","selectFollowedUsers","request","caller","response","detailedUser","module","modules","exports","id","loaded","__webpack_require__","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","_base","_converter","_file","_image","_photo","_rotate","_interopRequireDefault","obj","__esModule","default","_base2","_converter2","_file2","_image2","_photo2","_rotate2","_createClass","defineProperties","props","i","descriptor","enumerable","configurable","writable","defineProperty","Constructor","protoProps","staticProps","prototype","instance","TypeError","_classCallCheck","this","el","options","Promise","resolve","reject","input","querySelector","setAttribute","evt","output","_this","arr","Array","isArray","arr2","from","compressFile","photo","start","performance","now","startSize","orientation","then","load","startWidth","naturalWidth","startHeight","naturalHeight","width","height","endWidth","endHeight","imageToCanvas","canvas","iterations","base64prefix","prefix","loopCompression","targetSize","targetQuality","canvasToBase64","newSize","minQuality","base64","finalSize","end","difference","elapsedTimeInSeconds","initialSizeInMb","MB","endSizeInMb","endWidthInPx","endHeightInPx","initialWidthInPx","initialHeightInPx","sizeReducedInPercent","compressImage","all","mime","base64ToFile","apply","len","replace","split","match","arguments","byteString","atob","content","charCodeAt","Blob","Uint8Array","createElement","context","getContext","image","drawImage","translate","scale","rotate","Math","PI","toDataURL","KB","fileReader","FileReader","result","err","readAsDataURL","Image","targetWidth","targetHeight","originalAspectRatio","outputWidth","outputHeight","min","endSize","reader","onload","view","DataView","getUint16","byteLength","offset","marker","getUint32","little","tags","readAsArrayBuffer","slice","FollowedUserRow","user","Small","to","users","setUsers","postCaller","followCaller","signal","followed","getFollowedUsers","abort","u","limit","following","getFollowingUsers"],"mappings":"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","file":"static/js/13.95a73fd9.chunk.js","sourcesContent":["import React, { useState, useRef } from 'react'\r\nimport \"../profile/profileStyle.css\";\r\nimport { useBinder } from '../../hooks';\r\nimport { insertAuthUser } from '../../callers/authUserCaller';\r\nimport { doesExist } from '../../callers/userCaller';\r\nimport { WDoesUserExistResponse } from '../../../common/user';\r\ninterface SignUpForm{\r\n\r\n}\r\n\r\nexport const SignUpForm: React.FC<SignUpForm> = ()=> {\r\n    const [userTakenMsg, setUserTakenMsg] = useState(\"\");\r\n    const [msg, setMsg] = useState(\"\");\r\n    const [newUser, setNewUser, bindNewUser] = useBinder({userName: \"\", nickName: \"\", password: \"\", permission: 0});\r\n    const pw2 = useRef<HTMLInputElement>();\r\n\r\n    async function checkCommand(){\r\n        const doesExistResponse = await doesExist(newUser.userName);\r\n        if(doesExistResponse.status !== 200){\r\n            setUserTakenMsg(\"Server error: invalid response from the server.\");\r\n            return true;\r\n        }\r\n        if((await doesExistResponse.json() as WDoesUserExistResponse).exists){\r\n            setMsg(\"Username already taken.\");\r\n            setUserTakenMsg(\"Taken\");\r\n            return true;\r\n        } \r\n        setUserTakenMsg(\"Free\");\r\n        return false;\r\n    }\r\n    async function signUpCommand(){\r\n        if(newUser.userName.length === 0){\r\n            setMsg(\"The username must be at least one character long.\");\r\n            return false;\r\n        }\r\n        if(newUser.userName.length > 255){\r\n            setMsg(\"The username is too long.\");\r\n            return false;\r\n        }\r\n        if(await checkCommand()){\r\n            return false;\r\n        } \r\n        if(newUser.password !== pw2.current.value){\r\n            setMsg(\"The two passwords don't match.\");\r\n            return false;\r\n        }\r\n        console.log(\"requesting\");\r\n        await sendSignUpRequest();\r\n        return true;\r\n    }\r\n\r\n    async function sendSignUpRequest(){\r\n        console.log(\"sending request\")\r\n        const response = await insertAuthUser(newUser);\r\n        if(response.status === 201){\r\n            setMsg(\"You have successfully signed up to our website! Note: in this version of the application, all registered users automatically recieve level 2 (moderator) permissions.\");\r\n            return true;\r\n        } else {\r\n            setMsg(\"Server error: process failed.\");\r\n            return false;\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <h2>Sign up</h2>\r\n                <div className=\"form-container\">\r\n                    <label className=\"form-item\">New username:</label>\r\n                    <input value={newUser.userName} onChange={bindNewUser} className=\"form-item\" name=\"userName\" placeholder=\"Unique name which you can log in with\" />\r\n                    <div className=\"form-item\"></div><div className=\"form-item\"><span className=\"form-item\">{userTakenMsg}</span><button onClick={checkCommand}>Check</button></div>\r\n                    <label className=\"form-item\">New nickname:</label>\r\n                    <input value={newUser.nickName} onChange={bindNewUser} className=\"form-item\" name=\"nickName\" placeholder=\"Name seen by others\" />\r\n                    <label className=\"form-item\">New password:</label>\r\n                    <input value={newUser.password} onChange={bindNewUser} className=\"form-item\" type=\"password\" name=\"password\" placeholder=\"Password\" />\r\n                    <label className=\"form-item\">New password again:</label>\r\n                    <input ref={pw2} className=\"form-item\" type=\"password\" name=\"newPassword2\" placeholder=\"Password again\" />\r\n                </div>\r\n                <p>{msg}</p>\r\n                <button onClick={signUpCommand} className=\"login-btn\" type=\"button\">Sign Up</button>        \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default SignUpForm","import React, { useRef, useState, Fragment } from 'react'\r\nimport \"../profile/profileStyle.css\";\r\nimport { SignUpForm } from './SignUpForm';\r\nimport { useHistory } from 'react-router-dom';\r\nimport { login } from '../../callers/authUserCaller';\r\nimport { IMessageContext, MessageContext } from '../Messenger';\r\ninterface ILoginForm{\r\n    setPermissionlevel: (newPermission: number)=>any;\r\n}\r\n\r\nexport const LoginForm: React.FC<ILoginForm> = ({setPermissionlevel}: ILoginForm)=> {\r\n    const userName = useRef<HTMLInputElement>();\r\n    const password = useRef<HTMLInputElement>();\r\n    const autoLogin = useRef<HTMLInputElement>();\r\n    const { messenger } = React.useContext<IMessageContext>(MessageContext)\r\n    const signUpLine = \r\n    <Fragment>\r\n        <p>Not signed up yet?<button onClick={addSignUp}>Do it now!</button></p> \r\n        <div className=\"bottom-border\" />\r\n    </Fragment>\r\n    const [signUpForm, setSignUp] = useState(signUpLine);\r\n    const history = useHistory();\r\n\r\n    function addSignUp(){\r\n        setSignUp(<><div className=\"bottom-border\" /><SignUpForm /></>);\r\n    }\r\n\r\n    async function loginCommand(){\r\n        const loggedInUser = await login({userName: userName.current.value, nickName: undefined, permission: 1, password: password.current.value}, autoLogin.current.checked); //csak hogy ne egy sorban legyen m√°r\r\n        if(loggedInUser != null){\r\n            setPermissionlevel(loggedInUser.permission);\r\n            history.push(\"/rewer/home\");\r\n            messenger.addSuccess(`Logged in as: ${loggedInUser.userName}.`, 5000);\r\n        } else {\r\n            messenger.addWarning(\"Wrong username or password.\");\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <h2>Login</h2>\r\n            <form action=\"\">\r\n                <div className=\"form-container\">\r\n                    <label className=\"form-item\">Username:</label>\r\n                    <input className=\"form-item\" ref={userName} name=\"userName\" placeholder=\"username\" />\r\n                    <label className=\"form-item\">Password:</label>\r\n                    <input className=\"form-item\" ref={password} type=\"password\" placeholder=\"password\" name=\"password\" />\r\n                    <div className=\"form-item\"><label>Keep me logged in</label><input ref={autoLogin} type=\"checkbox\" /></div>\r\n                    <button onClick={loginCommand} className=\"login-btn form-item\" type=\"button\" name=\"submit\" >Login</button>\r\n                </div>\r\n            </form>\r\n                {signUpForm}    \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default LoginForm\r\n","/* eslint-disable react-hooks/exhaustive-deps */\r\nimport React, { Fragment, useState, useContext, useEffect } from 'react'\r\nimport { updatePassword } from '../../callers/authUserCaller';\r\nimport { onEnter } from '../../hooks';\r\nimport { MessageContext } from '../Messenger';\r\nimport \"./profileStyle.css\";\r\n\r\ninterface IChangePassword{\r\n    //????\r\n}\r\n\r\nexport const ChangePassword: React.FC<IChangePassword> = ()=> {\r\n    const [oldPw, setOldPw] = useState(\"\");\r\n    const [newPw1, setNewPw1] = useState(\"\");\r\n    const [newPw2, setNewPw2] = useState(\"\");\r\n    const { messenger } = useContext(MessageContext);\r\n\r\n    useEffect(()=>{\r\n        return ()=>{\r\n            messenger.clear();\r\n        }\r\n    }, []);\r\n\r\n    async function updatePasswordCommand(){\r\n        if(newPw1 !== newPw2){\r\n            messenger.addWarning(\"The two passwords don't match\");\r\n            clearInput();\r\n            return false;\r\n        }\r\n        if(await updatePassword({ userName: localStorage.getItem(\"userName\"), password: oldPw, permission: 0, nickName: localStorage.getItem(\"nickName\")}, newPw1)){\r\n            messenger.clear();\r\n            messenger.addWarning(\"Your password has been updated.\");\r\n            clearInput();\r\n            return true;\r\n        } else {\r\n            messenger.addFail(\"Access denied.\");\r\n            clearInput();\r\n            return false;\r\n        }\r\n    }\r\n\r\n    function clearInput(){\r\n        setOldPw(\"\");\r\n        setNewPw1(\"\");\r\n        setNewPw2(\"\");\r\n    }\r\n\r\n    return (\r\n       <Fragment>\r\n            <h2>Update password</h2>\r\n            <div>\r\n                <label className=\"form-item\">Current password:</label>\r\n                <input value={oldPw} onChange={e=> setOldPw(e.target.value)} type=\"password\" className=\"form-item\" placeholder=\"Enter old password\" />\r\n                <br/>\r\n                <label className=\"form-item\">New password:</label>\r\n                <input value={newPw1} onChange={e=> setNewPw1(e.target.value)} type=\"password\" className=\"form-item\" placeholder=\"Enter new password\" />\r\n                <br/>\r\n                <label className=\"form-item\">New password again:</label>\r\n                <input value={newPw2} onChange={e=> setNewPw2(e.target.value)} onKeyDown={(e)=> { onEnter(e, updatePasswordCommand) }} type=\"password\" className=\"form-item\" placeholder=\"Enter new password again\" />\r\n                <br/>\r\n            </div>\r\n            <button onClick={updatePasswordCommand} type=\"button\" className=\"center\">Update password</button>\r\n       </Fragment>\r\n    )\r\n}\r\nexport default ChangePassword;","/* eslint-disable react-hooks/exhaustive-deps */\r\nimport React, { useRef, useEffect, Fragment, useContext } from 'react'\r\nimport { useBinder, useImage } from '../../hooks';\r\nimport { logOut } from '../../callers/authUserCaller';\r\nimport { selectDetailedUser, uploadAvatar, updateUserInfo } from \"../../callers/userCaller\"\r\nimport { resizeImageFn } from '../../utils';\r\nimport ChangePassword from './ChangePassword';\r\nimport \"./profileStyle.css\";\r\nimport { MessageContext } from '../Messenger';\r\n\r\nexport default function MyProfile() {\r\n    const [myProfile, setMyProfile, bindMyProfile] = useBinder({ userName: localStorage.getItem(\"userName\"), nickName: localStorage.getItem(\"nickName\"), permission: 1, about: \"\" })\r\n    const imageFile = useRef<HTMLInputElement>();\r\n    const [imgsrc, onImgError, setImgsrc] = useImage(\"/rewer/uploads/avatars\", `${localStorage.getItem(\"userName\")}.jpg`);\r\n    const { messenger } = useContext(MessageContext);\r\n\r\n    useEffect(()=>{\r\n        getMyInfo();\r\n\r\n        return ()=>{\r\n            messenger.clear();\r\n        }\r\n    }, []);\r\n\r\n    async function logoutCommand(){\r\n        await logOut();\r\n        window.location.reload();\r\n    }\r\n\r\n    async function updateUserInfoCommand(){\r\n        if(await updateUserInfo(myProfile)){\r\n            messenger.addSuccess(\"Your profile has been updated.\", 5000);\r\n        } else {\r\n            messenger.addFail(\"Server error: failed to update your profile.\");\r\n        }\r\n    }\r\n\r\n    async function getMyInfo(){\r\n        const profile = await selectDetailedUser(localStorage.getItem(\"userName\"));\r\n        if(profile){\r\n            setMyProfile(profile);\r\n        }\r\n    }\r\n\r\n    function handleKeyDown(e){\r\n        if(e.key === 'Enter'){\r\n            updateUserInfoCommand();\r\n        }\r\n    }\r\n\r\n    async function uploadImageFileCommand(){\r\n        const formData = new FormData();\r\n        if(!imageFile.current.files[0]){\r\n            messenger.addWarning(\"No file was selected.\");\r\n            return;\r\n        }\r\n        const resizedFile = await resizeImageFn(imageFile.current.files[0], 300, 300, 0.8);\r\n        formData.append(\"avatar\", resizedFile, `${localStorage.getItem(\"userName\")}.jpg`);\r\n        if((await uploadAvatar(formData)).status === 200){\r\n            messenger.addSuccess(\"Avatar updated\", 6000);\r\n            setImgsrc(\"/rewer/uploads/avatars\", `${localStorage.getItem(\"userName\")}.jpg?${new Date().getTime()}`); //getTime() is to fight caching, this shit is the standard solution from now on\r\n        } else {\r\n            messenger.addFail(\"Upload failed. Make sure file's size is not bigger than 10MB.\");\r\n        }\r\n    }\r\n    return (\r\n        <Fragment>\r\n            <h3>User settings</h3>\r\n            <button onClick={logoutCommand}>Log out</button>\r\n            <div className=\"profile-grid\">\r\n                <div className=\"profile-grid-item\">    \r\n                    <img \r\n                        src={imgsrc} \r\n                        onError={onImgError}\r\n                        className=\"image\" \r\n                        alt=\"Avatar\" \r\n                        title=\"Avatar\"  />\r\n                    <input ref={imageFile}  className=\"file-input\" type=\"file\" accept=\".png,.jpg\" />\r\n                    <button onClick={uploadImageFileCommand} type=\"button\">Upload</button>\r\n                </div>\r\n                <div className=\"profile-grid-item\">\r\n                    <h1>{localStorage.getItem(\"userName\")}</h1>\r\n                    <div>\r\n                        <label>My nickname: </label>\r\n                        <input className=\"nickname-input\" type=\"text\" name=\"nickName\" value={myProfile.nickName} onKeyDown={handleKeyDown}  onChange={bindMyProfile} />\r\n                        <button onClick={updateUserInfoCommand}  type=\"button\" className=\"save\" >Save</button>\r\n                    </div>\r\n                    <textarea className=\"about\" name=\"about\" value={myProfile.about} onChange={bindMyProfile} rows={10} ></textarea>\r\n                </div>\r\n            </div>\r\n            <div className=\"bottom-border\"></div>\r\n            <ChangePassword />\r\n        </Fragment>\r\n    )\r\n}\r\n","import React, { Fragment, useEffect } from 'react'\r\nimport \"../main.css\";\r\nimport LoginForm from '../components/login/LoginForm';\r\nimport MyProfile from '../components/profile/MyProfile';\r\nimport FollowedUsers from '../components/profile/FollowedUsers';\r\nimport FollowingUsers from '../components/profile/FollowingUsers';\r\n\r\ninterface ILogin{\r\n    setPermissionLevel: (newPermission: number)=>any;\r\n}\r\n\r\nexport const Login: React.FC<ILogin> = ({setPermissionLevel}: ILogin)=> {\r\n    useEffect(()=>{\r\n        document.title = \"My Profile - Rewer\";\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"main-container\">\r\n            {localStorage.getItem(\"userName\") != null ?\r\n            (<Fragment>\r\n                <MyProfile />\r\n                <FollowedUsers />\r\n                    <div className=\"bottom-border\" />\r\n                    <FollowingUsers length={20} />\r\n            </Fragment>):\r\n            (<LoginForm setPermissionlevel={setPermissionLevel} />)}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Login;","import { useState, useRef } from \"react\";\r\nexport function useAsyncReference<T>(value: T) {\r\n    const ref = useRef(value);\r\n    const [, forceRender] = useState(false);\r\n    const updateState = (newState) => {\r\n        if (!Object.is(ref.current, newState)) {\r\n            ref.current = newState;\r\n            forceRender(s => !s);\r\n        }\r\n    }\r\n    return [ref, updateState] as const;\r\n}\r\n\r\nexport function useBinder<T>(value: T){\r\n    const [get, set] = useState<T>(value);\r\n    const bind = (event)=>{\r\n        set({...get, [event.target.name]: event.target.value});\r\n    }\r\n    return [get, set, bind] as const;\r\n}\r\n\r\nexport function useAsyncBinder<T>(value: T){\r\n    const ref = useRef(value);\r\n    const [, forceRender] = useState(false);\r\n    const updateState = (newState) => {\r\n        if (!Object.is(ref.current, newState)) {\r\n            ref.current = newState;\r\n            forceRender(s => !s);\r\n        }\r\n    }\r\n    const bind = (event) => {\r\n        updateState({...ref.current, [event.target.name]: event.target.value});\r\n    }\r\n    return [ref, updateState, bind] as const;\r\n}\r\n\r\nexport function useCutter(defaultText: string, defaultCutPos = 0): readonly [string, boolean, (text: string, custPos?: number)=>void]{\r\n    const [firstText, firstCut] = getCutText(defaultText, defaultCutPos > 0, defaultCutPos);\r\n    const [isCut, setIsCut] = useState(firstCut);\r\n    const [outputText, setOutputText] = useState(firstText);\r\n\r\n    const cut = (text: string, cutPos = 0) => {\r\n        const [newText, didCut] = getCutText(text, cutPos > 0, cutPos);\r\n        setOutputText(newText);\r\n        setIsCut(didCut);\r\n    }\r\n\r\n    return [outputText, isCut, cut] as const;\r\n}\r\n\r\nfunction getCutText(text: string, toCut: boolean, cutPos: number): [string, boolean]{\r\n    if(toCut && text.length > cutPos){\r\n        return [text.substring(0, cutPos) + \"...\", true];\r\n    }\r\n    return [text, false];\r\n}\r\n\r\nexport function setBinder(event, object, setter: (any)=> void){\r\n    setter({...object.current, [event.target.name]: event.target.value});\r\n}\r\n\r\nexport function onEnter(event, callback){\r\n    if (event.key === 'Enter') {\r\n        callback();\r\n    }\r\n}\r\n\r\nexport function useScroll(pos: number, callback: ()=> any): readonly [()=>void, ()=>void]{ \r\n    let newPos = pos;\r\n    if(pos > 1 || pos < 0) newPos = 0.8;\r\n    const position = useRef(newPos);\r\n    const listener = ()=>{\r\n        if((window.innerHeight + window.scrollY) >= (document.body.offsetHeight*position.current)){\r\n            callback();\r\n        }\r\n    }\r\n    const addListener = () =>{\r\n        window.addEventListener(\"scroll\", listener);\r\n    }\r\n    const removeListener = ()=>{\r\n        window.removeEventListener(\"scroll\", listener);\r\n    }\r\n    return [addListener, removeListener] as const;\r\n}\r\n\r\nexport enum ESize{\r\n    Normal = \"\",\r\n    Medium = \"medium-\",\r\n    Small = \"small-\",\r\n}\r\n\r\nexport function useImage(path: string, fileName: string, size = ESize.Normal, tryAgain = false){\r\n    const [imgSrc, setImgSrc] = useState<string>(`${path}/${size}${fileName}`);\r\n    const tryAgainRef = useRef(tryAgain);\r\n    const onError= () =>{\r\n        if(tryAgainRef.current){\r\n            setImgSrc(`${path}/${ESize.Normal}${fileName}`);\r\n            tryAgainRef.current = false;\r\n        } else {\r\n            setImgSrc(`${path}/${size}0.jpg`);\r\n        }\r\n    }\r\n    const imgSrcSetter = (newPath: string, newFileName: string) => {\r\n        setImgSrc(`${newPath}/${size}${newFileName}`);\r\n    }\r\n    return [imgSrc, onError, imgSrcSetter] as const;\r\n}\r\n\r\nexport interface IWindowState{\r\n    name: string;\r\n    maxValue: number;\r\n}\r\n\r\nexport function useWidth(defWindowStates: IWindowState[]){\r\n    const windowsStates = useRef(defWindowStates.sort(compareWindowStates));\r\n    const [currentWindowState, setCurrentWindowState] = useState(windowsStates.current.find(w=> w.maxValue > window.innerWidth));\r\n    const listen = ()=>{\r\n        window.addEventListener(\"resize\", ()=>{\r\n            windowStateSetter();\r\n        });\r\n    }\r\n    const cleanUpListener = ()=>{\r\n        window.removeEventListener(\"resize\", ()=>{\r\n            windowStateSetter();\r\n        });\r\n    }\r\n    const windowStateSetter = ()=>{\r\n        setCurrentWindowState(windowsStates.current.find(w=> w.maxValue > window.innerWidth));\r\n    }\r\n    return [currentWindowState, listen, cleanUpListener] as const;\r\n}\r\n\r\nfunction compareWindowStates(wstate1: IWindowState, wstate2: IWindowState){\r\n    if(wstate1.maxValue < wstate2.maxValue) return -1;\r\n    if(wstate1.maxValue > wstate2.maxValue) return 1;\r\n    return 0;\r\n}","export const itemReplacer = (array, oldItem, newItem) => {\r\n  array.map(item=> item === oldItem? newItem : item);\r\n}\r\n\r\nexport const replacedList = (array, oldItem, newItem) => {\r\n  return array.map(item=> item === oldItem? newItem : item);\r\n}\r\n\r\nexport async function resizeImageFn(file, maxWidth: number, maxHeight: number, quality = 1) {\r\n  const Compress = require('compress.js');\r\n  const compress = new Compress();\r\n  const resizedImage = await compress.compress([file], {\r\n    size: 1,\r\n    quality: quality, \r\n    maxWidth: maxWidth, \r\n    maxHeight: maxHeight, \r\n    resize: true\r\n  })\r\n  const img = resizedImage[0];\r\n  const base64str = img.data;\r\n  const imgExt = img.ext;\r\n  const resizedFiile = Compress.convertBase64ToFile(base64str, imgExt);\r\n  return resizedFiile;\r\n}","import { IDetailedUser, IUser, WDoesUserExistRequest, WSelectFollowedUsersRequest, WSelectFollowersRequest } from \"../../common/user\";\r\nimport * as caller from \"./caller\";\r\n\r\nexport const userPath = {\r\n    doesExist: \"/user/does_exist\",\r\n    selectDetailedUser: \"/user/select_detailed_user\",\r\n    uploadAvatar: \"/user/upload_avatar\",\r\n    updateUserInfo: \"/user/update_user_info\",\r\n    selectFollowers: \"/user/select_followers\",\r\n    selectFollowedUsers: \"/user/select_followed_users\"\r\n}\r\n\r\nexport async function doesExist(userName: string): Promise<Response>{\r\n    const request: WDoesUserExistRequest = { userName: userName };\r\n    const response = await caller.POSTAsynch(\"/user/does_exist\", request);\r\n    return response;\r\n}\r\n\r\nexport async function selectDetailedUser(userName: string): Promise<IDetailedUser | null>{\r\n    const request = { userName: userName };\r\n    const response = await caller.POSTAsynch(\"/user/select_detailed_user\", request);\r\n    if(response.status === 200){\r\n        return await response.json();\r\n    }\r\n    return null;\r\n}\r\n\r\nexport async function uploadAvatar(file: FormData){\r\n    const response = await caller.UploadFile(\"/user/upload_avatar\", file);\r\n    return response;\r\n}\r\n\r\nexport async function updateUserInfo(detailedUser: IDetailedUser): Promise<boolean>{\r\n    const response = await caller.POSTAsynch(\"/user/update_user_info\", detailedUser);\r\n    if(response.status === 200){\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nexport async function selectFollowers(data: WSelectFollowersRequest): Promise<IUser[] | null>{\r\n    const response = await caller.POSTAsynch(\"/user/select_followers\", data);\r\n    if(response.status !== 200) return null;\r\n    return await response.json();\r\n}\r\n\r\nexport async function selectFollowedUsers(data: WSelectFollowedUsersRequest): Promise<IUser[] | null>{\r\n    const response = await caller.POSTAsynch(\"/user/select_followed_users\", data);\r\n    if(response.status !== 200) return null;\r\n    return await response.json();\r\n}","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Compress\"] = factory();\n\telse\n\t\troot[\"Compress\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Compress\"] = factory();\n\telse\n\t\troot[\"Compress\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [module, __webpack_require__(1), __webpack_require__(2), __webpack_require__(3), __webpack_require__(4), __webpack_require__(5), __webpack_require__(6)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(module, require('./core/base64.js'), require('./core/converter.js'), require('./core/file.js'), require('./core/image.js'), require('./core/photo.js'), require('./core/rotate.js'));\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod, global.base64, global.converter, global.file, global.image, global.photo, global.rotate);\n\t    global.Compress = mod.exports;\n\t  }\n\t})(this, function (module, _base, _converter, _file, _image, _photo, _rotate) {\n\t  'use strict';\n\t\n\t  var _base2 = _interopRequireDefault(_base);\n\t\n\t  var _converter2 = _interopRequireDefault(_converter);\n\t\n\t  var _file2 = _interopRequireDefault(_file);\n\t\n\t  var _image2 = _interopRequireDefault(_image);\n\t\n\t  var _photo2 = _interopRequireDefault(_photo);\n\t\n\t  var _rotate2 = _interopRequireDefault(_rotate);\n\t\n\t  function _interopRequireDefault(obj) {\n\t    return obj && obj.__esModule ? obj : {\n\t      default: obj\n\t    };\n\t  }\n\t\n\t  function _toConsumableArray(arr) {\n\t    if (Array.isArray(arr)) {\n\t      for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n\t        arr2[i] = arr[i];\n\t      }\n\t\n\t      return arr2;\n\t    } else {\n\t      return Array.from(arr);\n\t    }\n\t  }\n\t\n\t  function _classCallCheck(instance, Constructor) {\n\t    if (!(instance instanceof Constructor)) {\n\t      throw new TypeError(\"Cannot call a class as a function\");\n\t    }\n\t  }\n\t\n\t  var _createClass = function () {\n\t    function defineProperties(target, props) {\n\t      for (var i = 0; i < props.length; i++) {\n\t        var descriptor = props[i];\n\t        descriptor.enumerable = descriptor.enumerable || false;\n\t        descriptor.configurable = true;\n\t        if (\"value\" in descriptor) descriptor.writable = true;\n\t        Object.defineProperty(target, descriptor.key, descriptor);\n\t      }\n\t    }\n\t\n\t    return function (Constructor, protoProps, staticProps) {\n\t      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n\t      if (staticProps) defineProperties(Constructor, staticProps);\n\t      return Constructor;\n\t    };\n\t  }();\n\t\n\t  var Compress = function () {\n\t    function Compress() {\n\t      _classCallCheck(this, Compress);\n\t    }\n\t\n\t    _createClass(Compress, [{\n\t      key: 'attach',\n\t      value: function attach(el, options) {\n\t        var _this = this;\n\t\n\t        return new Promise(function (resolve, reject) {\n\t          var input = document.querySelector(el);\n\t          input.setAttribute('accept', 'image/*');\n\t          input.addEventListener('change', function (evt) {\n\t            var output = _this.compress([].concat(_toConsumableArray(evt.target.files)), options);\n\t            resolve(output);\n\t          }, false);\n\t        });\n\t      }\n\t    }, {\n\t      key: 'compress',\n\t      value: function compress(files, options) {\n\t        function compressFile(file, options) {\n\t          var photo = new _photo2.default(options);\n\t          photo.start = window.performance.now();\n\t          photo.alt = file.name;\n\t          photo.ext = file.type;\n\t          photo.startSize = file.size;\n\t\n\t          return _rotate2.default.orientation(file).then(function (orientation) {\n\t            photo.orientation = orientation;\n\t            return _file2.default.load(file);\n\t          }).then(compressImage(photo));\n\t        }\n\t        function compressImage(photo) {\n\t          return function (src) {\n\t            return _image2.default.load(src).then(function (img) {\n\t              photo.startWidth = img.naturalWidth;\n\t              photo.startHeight = img.naturalHeight;\n\t\n\t              if (photo.resize) {\n\t                var _Image$resize = _image2.default.resize(photo.maxWidth, photo.maxHeight)(img.naturalWidth, img.naturalHeight),\n\t                    width = _Image$resize.width,\n\t                    height = _Image$resize.height;\n\t\n\t                photo.endWidth = width;\n\t                photo.endHeight = height;\n\t              } else {\n\t                photo.endWidth = img.naturalWidth;\n\t                photo.endHeight = img.naturalHeight;\n\t              }\n\t              return _converter2.default.imageToCanvas(photo.endWidth, photo.endHeight, photo.orientation)(img);\n\t            }).then(function (canvas) {\n\t              photo.iterations = 1;\n\t\n\t              photo.base64prefix = _base2.default.prefix(photo.ext);\n\t              return loopCompression(canvas, photo.startSize, photo.quality, photo.size, photo.minQuality, photo.iterations);\n\t            }).then(function (base64) {\n\t              photo.finalSize = _base2.default.size(base64);\n\t              return _base2.default.data(base64);\n\t            }).then(function (data) {\n\t              photo.end = window.performance.now();\n\t              var difference = photo.end - photo.start;\n\t\n\t              return {\n\t                data: data,\n\t                prefix: photo.base64prefix,\n\t                elapsedTimeInSeconds: difference / 1000,\n\t                alt: photo.alt,\n\t                initialSizeInMb: _converter2.default.size(photo.startSize).MB,\n\t                endSizeInMb: _converter2.default.size(photo.finalSize).MB,\n\t                ext: photo.ext,\n\t                quality: photo.quality,\n\t                endWidthInPx: photo.endWidth,\n\t                endHeightInPx: photo.endHeight,\n\t                initialWidthInPx: photo.startWidth,\n\t                initialHeightInPx: photo.startHeight,\n\t                sizeReducedInPercent: (photo.startSize - photo.finalSize) / photo.startSize * 100,\n\t                iterations: photo.iterations\n\t              };\n\t            });\n\t          };\n\t        }\n\t        function loopCompression(canvas, size) {\n\t          var quality = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\t          var targetSize = arguments[3];\n\t          var targetQuality = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;\n\t          var iterations = arguments[5];\n\t\n\t          var base64str = _converter2.default.canvasToBase64(canvas, quality);\n\t          var newSize = _base2.default.size(base64str);\n\t\n\t          iterations += 1;\n\t\n\t          if (newSize > targetSize) {\n\t            return loopCompression(canvas, newSize, quality - 0.1, targetSize, targetQuality, iterations);\n\t          }\n\t\n\t          if (quality > targetQuality) {\n\t            return loopCompression(canvas, newSize, quality - 0.1, targetSize, targetQuality, iterations);\n\t          }\n\t\n\t          if (quality < 0.5) {\n\t            return base64str;\n\t          }\n\t          return base64str;\n\t        }\n\t        return Promise.all(files.map(function (file) {\n\t          return compressFile(file, options);\n\t        }));\n\t      }\n\t    }], [{\n\t      key: 'convertBase64ToFile',\n\t      value: function convertBase64ToFile(base64, mime) {\n\t        return _converter2.default.base64ToFile(base64, mime);\n\t      }\n\t    }]);\n\t\n\t    return Compress;\n\t  }();\n\t\n\t  module.exports = Compress;\n\t});\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(exports);\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod.exports);\n\t    global.base64 = mod.exports;\n\t  }\n\t})(this, function (exports) {\n\t  'use strict';\n\t\n\t  Object.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t  });\n\t  var size = function size(base64) {\n\t    var len = base64.replace(/^data:image\\/\\w+;base64,/, '').length;\n\t    return (len - 814) / 1.37;\n\t  };\n\t\n\t  var mime = function mime(base64) {\n\t    return base64.split(';')[0].match(/jpeg|png|gif/)[0];\n\t  };\n\t\n\t  var data = function data(base64) {\n\t    return base64.replace(/^data:image\\/\\w+;base64,/, '');\n\t  };\n\t\n\t  var prefix = function prefix(ext) {\n\t    return 'data:' + ext + ';base64,';\n\t  };\n\t\n\t  exports.default = { size: size, mime: mime, data: data, prefix: prefix };\n\t});\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(exports);\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod.exports);\n\t    global.converter = mod.exports;\n\t  }\n\t})(this, function (exports) {\n\t  'use strict';\n\t\n\t  Object.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t  });\n\t\n\t  var base64ToFile = function base64ToFile(base64) {\n\t    var mime = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'image/jpeg';\n\t\n\t    var byteString = window.atob(base64);\n\t    var content = [];\n\t    for (var i = 0; i < byteString.length; i++) {\n\t      content[i] = byteString.charCodeAt(i);\n\t    }\n\t    return new window.Blob([new Uint8Array(content)], { type: mime });\n\t  };\n\t\n\t  var imageToCanvas = function imageToCanvas(width, height, orientation) {\n\t    var canvas = document.createElement('canvas');\n\t    var context = canvas.getContext('2d');\n\t\n\t    canvas.width = width;\n\t    canvas.height = height;\n\t\n\t\n\t    return function (image) {\n\t      if (!orientation || orientation > 8) {\n\t        context.drawImage(image, 0, 0, canvas.width, canvas.height);\n\t        return canvas;\n\t      }\n\t      if (orientation > 4) {\n\t        canvas.width = height;\n\t        canvas.height = width;\n\t      }\n\t      switch (orientation) {\n\t        case 2:\n\t          context.translate(width, 0);\n\t          context.scale(-1, 1);\n\t          break;\n\t        case 3:\n\t          context.translate(width, height);\n\t          context.rotate(Math.PI);\n\t          break;\n\t        case 4:\n\t          context.translate(0, height);\n\t          context.scale(1, -1);\n\t          break;\n\t        case 5:\n\t          context.rotate(0.5 * Math.PI);\n\t          context.scale(1, -1);\n\t          break;\n\t        case 6:\n\t          context.rotate(0.5 * Math.PI);\n\t          context.translate(0, -height);\n\t          break;\n\t        case 7:\n\t          context.rotate(0.5 * Math.PI);\n\t          context.translate(width, -height);\n\t          context.scale(-1, 1);\n\t          break;\n\t        case 8:\n\t          context.rotate(-0.5 * Math.PI);\n\t          context.translate(-width, 0);\n\t          break;\n\t      }\n\t      if (orientation > 4) {\n\t        context.drawImage(image, 0, 0, canvas.height, canvas.width);\n\t      } else {\n\t        context.drawImage(image, 0, 0, canvas.width, canvas.height);\n\t      }\n\t      return canvas;\n\t    };\n\t  };\n\t\n\t  var canvasToBase64 = function canvasToBase64(canvas) {\n\t    var quality = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0.75;\n\t\n\t    var base64 = canvas.toDataURL('image/jpeg', quality);\n\t    return base64;\n\t  };\n\t\n\t  var size = function size(_size) {\n\t    return {\n\t      KB: _size / 1000,\n\t      MB: _size / (1000 * 1000)\n\t    };\n\t  };\n\t\n\t  exports.default = { base64ToFile: base64ToFile, imageToCanvas: imageToCanvas, canvasToBase64: canvasToBase64, size: size };\n\t});\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(exports);\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod.exports);\n\t    global.file = mod.exports;\n\t  }\n\t})(this, function (exports) {\n\t  'use strict';\n\t\n\t  Object.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t  });\n\t\n\t  var load = function load(file) {\n\t    return new Promise(function (resolve, reject) {\n\t      var fileReader = new window.FileReader();\n\t      fileReader.addEventListener('load', function (evt) {\n\t        resolve(evt.target.result);\n\t      }, false);\n\t\n\t      fileReader.addEventListener('error', function (err) {\n\t        reject(err);\n\t      }, false);\n\t\n\t      fileReader.readAsDataURL(file);\n\t    });\n\t  };\n\t\n\t  exports.default = { load: load };\n\t});\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(exports);\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod.exports);\n\t    global.image = mod.exports;\n\t  }\n\t})(this, function (exports) {\n\t  'use strict';\n\t\n\t  Object.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t  });\n\t\n\t  var load = function load(src) {\n\t    return new Promise(function (resolve, reject) {\n\t      var img = new window.Image();\n\t      img.addEventListener('load', function () {\n\t        resolve(img);\n\t      }, false);\n\t\n\t      img.addEventListener('error', function (err) {\n\t        reject(err);\n\t      }, false);\n\t\n\t      img.src = src;\n\t    });\n\t  };\n\t\n\t  var resize = function resize(targetWidth, targetHeight) {\n\t    return function (width, height) {\n\t      if (!targetWidth && !targetHeight) return { width: width, height: height };\n\t\n\t      var originalAspectRatio = width / height;\n\t      var targetAspectRatio = targetWidth / targetHeight;\n\t\n\t      var outputWidth = void 0,\n\t          outputHeight = void 0;\n\t\n\t      if (originalAspectRatio > targetAspectRatio) {\n\t        outputWidth = Math.min(width, targetWidth);\n\t        outputHeight = outputWidth / originalAspectRatio;\n\t      } else {\n\t        outputHeight = Math.min(height, targetHeight);\n\t        outputWidth = outputHeight * originalAspectRatio;\n\t      }\n\t\n\t      return { width: outputWidth, height: outputHeight };\n\t    };\n\t  };\n\t\n\t  exports.default = { load: load, resize: resize };\n\t});\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(exports);\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod.exports);\n\t    global.photo = mod.exports;\n\t  }\n\t})(this, function (exports) {\n\t  \"use strict\";\n\t\n\t  Object.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t  });\n\t\n\t  function _classCallCheck(instance, Constructor) {\n\t    if (!(instance instanceof Constructor)) {\n\t      throw new TypeError(\"Cannot call a class as a function\");\n\t    }\n\t  }\n\t\n\t  var Photo = function Photo(_ref) {\n\t    var _ref$quality = _ref.quality,\n\t        quality = _ref$quality === undefined ? 0.75 : _ref$quality,\n\t        _ref$size = _ref.size,\n\t        size = _ref$size === undefined ? 2 : _ref$size,\n\t        _ref$maxWidth = _ref.maxWidth,\n\t        maxWidth = _ref$maxWidth === undefined ? 1920 : _ref$maxWidth,\n\t        _ref$maxHeight = _ref.maxHeight,\n\t        maxHeight = _ref$maxHeight === undefined ? 1920 : _ref$maxHeight,\n\t        _ref$resize = _ref.resize,\n\t        resize = _ref$resize === undefined ? true : _ref$resize;\n\t\n\t    _classCallCheck(this, Photo);\n\t\n\t    this.start = window.performance.now();\n\t    this.end = null;\n\t\n\t    this.alt = null;\n\t    this.ext = null;\n\t    this.startSize = null;\n\t    this.startWidth = null;\n\t    this.startHeight = null;\n\t\n\t    this.size = size * 1000 * 1000;\n\t    this.endSize = null;\n\t    this.endWidth = null;\n\t    this.endHeight = null;\n\t    this.iterations = 0;\n\t    this.base64prefix = null;\n\t\n\t    this.quality = quality;\n\t    this.resize = resize;\n\t    this.maxWidth = maxWidth;\n\t    this.maxHeight = maxHeight;\n\t    this.orientation = 1;\n\t  };\n\t\n\t  exports.default = Photo;\n\t});\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {\n\t  if (true) {\n\t    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t  } else if (typeof exports !== \"undefined\") {\n\t    factory(exports);\n\t  } else {\n\t    var mod = {\n\t      exports: {}\n\t    };\n\t    factory(mod.exports);\n\t    global.rotate = mod.exports;\n\t  }\n\t})(this, function (exports) {\n\t  \"use strict\";\n\t\n\t  Object.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t  });\n\t\n\t\n\t  var orientation = function orientation(file) {\n\t    return new Promise(function (resolve, reject) {\n\t      var reader = new window.FileReader();\n\t\n\t      reader.onload = function (event) {\n\t        var view = new DataView(event.target.result);\n\t\n\t        if (view.getUint16(0, false) !== 0xFFD8) {\n\t          resolve(-2);\n\t        }\n\t        var length = view.byteLength;\n\t        var offset = 2;\n\t\n\t        while (offset < length) {\n\t          var marker = view.getUint16(offset, false);\n\t          offset += 2;\n\t\n\t          if (marker === 0xFFE1) {\n\t            if (view.getUint32(offset += 2, false) !== 0x45786966) {\n\t              resolve(-1);\n\t            }\n\t            var little = view.getUint16(offset += 6, false) === 0x4949;\n\t            offset += view.getUint32(offset + 4, little);\n\t            var tags = view.getUint16(offset, little);\n\t            offset += 2;\n\t\n\t            for (var i = 0; i < tags; i++) {\n\t              if (view.getUint16(offset + i * 12, little) === 0x0112) {\n\t                resolve(view.getUint16(offset + i * 12 + 8, little));\n\t              }\n\t            }\n\t          } else if ((marker & 0xFF00) !== 0xFF00) break;else offset += view.getUint16(offset, false);\n\t        }\n\t        resolve(-1);\n\t      };\n\t      reader.readAsArrayBuffer(file.slice(0, 64 * 1024));\n\t    });\n\t  };\n\t\n\t  exports.default = { orientation: orientation };\n\t});\n\n/***/ })\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// index.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5c04cbde4fb824613eb6","import Base64 from './core/base64.js'\nimport Converter from './core/converter.js'\nimport File from './core/file.js'\nimport Image from './core/image.js'\nimport Photo from './core/photo.js'\nimport Rotate from './core/rotate.js'\n\nclass Compress {\n  attach (el, options) {\n    return new Promise((resolve, reject) => {\n      const input = document.querySelector(el)\n      input.setAttribute('accept', 'image/*')\n      input.addEventListener('change', (evt) => {\n        const output = this.compress([...evt.target.files], options)\n        resolve(output)\n      }, false)\n    })\n  }\n\n  compress (files, options) {\n    function compressFile (file, options) {\n      // Create a new photo object\n      const photo = new Photo(options)\n      photo.start = window.performance.now()\n      photo.alt = file.name\n      photo.ext = file.type\n      photo.startSize = file.size\n\n      return Rotate.orientation(file)\n      .then((orientation) => {\n        photo.orientation = orientation\n        return File.load(file)\n      })\n      .then(compressImage(photo))\n    }\n    function compressImage (photo) {\n      return (src) => {\n        return Image.load(src).then((img) => {\n          // Store the initial dimensions\n          photo.startWidth = img.naturalWidth\n          photo.startHeight = img.naturalHeight\n          // Resize the image\n          if (photo.resize) {\n            const { width, height } = Image.resize(photo.maxWidth, photo.maxHeight)(img.naturalWidth, img.naturalHeight)\n            photo.endWidth = width\n            photo.endHeight = height\n          } else {\n            photo.endWidth = img.naturalWidth\n            photo.endHeight = img.naturalHeight\n          }\n          return Converter.imageToCanvas(photo.endWidth, photo.endHeight, photo.orientation)(img)\n        })\n        .then((canvas) => {\n          photo.iterations = 1\n          // Base64.mime(Converter.canvasToBase64(canvas))\n          photo.base64prefix = Base64.prefix(photo.ext)\n          return loopCompression(canvas, photo.startSize, photo.quality, photo.size, photo.minQuality, photo.iterations)\n        })\n        .then((base64) => {\n          photo.finalSize = Base64.size(base64)\n          return Base64.data(base64)\n        })\n        .then((data) => {\n          photo.end = window.performance.now()\n          const difference = photo.end - photo.start // in ms\n\n          return {\n            data: data,\n            prefix: photo.base64prefix,\n            elapsedTimeInSeconds: difference / 1000, // in seconds\n            alt: photo.alt,\n            initialSizeInMb: Converter.size(photo.startSize).MB,\n            endSizeInMb: Converter.size(photo.finalSize).MB,\n            ext: photo.ext,\n            quality: photo.quality,\n            endWidthInPx: photo.endWidth,\n            endHeightInPx: photo.endHeight,\n            initialWidthInPx: photo.startWidth,\n            initialHeightInPx: photo.startHeight,\n            sizeReducedInPercent: (photo.startSize - photo.finalSize) / photo.startSize * 100,\n            iterations: photo.iterations\n          }\n        })\n      }\n    }\n    function loopCompression (canvas, size, quality = 1, targetSize, targetQuality = 1, iterations) {\n      const base64str = Converter.canvasToBase64(canvas, quality)\n      const newSize = Base64.size(base64str)\n      // const base64str = convertCanvasToBase64(src)\n      // const size = getFileSize(base64str);\n      iterations += 1\n      // add in iteration count\n      if (newSize > targetSize) {\n        return loopCompression(canvas, newSize, quality - 0.1, targetSize, targetQuality, iterations)\n      }\n\n      if (quality > targetQuality) {\n        return loopCompression(canvas, newSize, quality - 0.1, targetSize, targetQuality, iterations)\n      }\n\n      if (quality < 0.5) {\n        return base64str\n      }\n      return base64str\n    }\n    return Promise.all(files.map((file) => {\n      return compressFile(file, options)\n    }))\n  }\n  static convertBase64ToFile (base64, mime) {\n    return Converter.base64ToFile(base64, mime)\n  }\n}\n\n// Supported input formats\n// image/png, image/jpeg, image/jpg, image/gif, image/bmp, image/tiff, image/x-icon,  image/svg+xml, image/webp, image/xxx\n// image/png, image/jpeg, image/webp\nmodule.exports = Compress\n\n\n\n// WEBPACK FOOTER //\n// ./src/Compress.js","const size = (base64) => {\n  const len = base64.replace(/^data:image\\/\\w+;base64,/, '').length\n  return (len - 814) / 1.37\n  // return len * 3 / 4\n}\n\n// strip off the data: url prefix to get just the base64-encoded bytes\n// var data = img.replace(/^data:image\\/\\w+;base64,/, \"\");\nconst mime = (base64) => {\n  return base64.split(';')[0].match(/jpeg|png|gif/)[0]\n}\n\nconst data = (base64) => {\n  return base64.replace(/^data:image\\/\\w+;base64,/, '')\n}\n\nconst prefix = (ext) => {\n  return `data:${ext};base64,`\n}\n\nexport default { size, mime, data, prefix }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/base64.js","\nconst base64ToFile = (base64, mime = 'image/jpeg') => {\n  const byteString = window.atob(base64)\n  const content = []\n  for (let i = 0; i < byteString.length; i++) {\n    content[i] = byteString.charCodeAt(i)\n  }\n  return new window.Blob([new Uint8Array(content)], {type: mime})\n}\n\nconst imageToCanvas = (width, height, orientation) => {\n  const canvas = document.createElement('canvas')\n  const context = canvas.getContext('2d')\n\n  canvas.width = width\n  canvas.height = height\n  // canvas.style.width = width\n  // canvas.style.height = height\n\n  return (image) => {\n    if (!orientation || orientation > 8) {\n      context.drawImage(image, 0, 0, canvas.width, canvas.height)\n      return canvas\n    }\n    if (orientation > 4) {\n      canvas.width = height\n      canvas.height = width\n      // canvas.style.width = height\n      // canvas.style.height = width\n    }\n    switch (orientation) {\n      case 2:\n        // horizontal flip\n        context.translate(width, 0)\n        context.scale(-1, 1)\n        break\n      case 3:\n        // 180¬∞ rotate left\n        context.translate(width, height)\n        context.rotate(Math.PI)\n        break\n      case 4:\n        // vertical flip\n        context.translate(0, height)\n        context.scale(1, -1)\n        break\n      case 5:\n        // vertical flip + 90 rotate right\n        context.rotate(0.5 * Math.PI)\n        context.scale(1, -1)\n        break\n      case 6:\n        // 90¬∞ rotate right\n        context.rotate(0.5 * Math.PI)\n        context.translate(0, -height)\n        break\n      case 7:\n        // horizontal flip + 90 rotate right\n        context.rotate(0.5 * Math.PI)\n        context.translate(width, -height)\n        context.scale(-1, 1)\n        break\n      case 8:\n        // 90¬∞ rotate left\n        context.rotate(-0.5 * Math.PI)\n        context.translate(-width, 0)\n        break\n    }\n    if (orientation > 4) {\n      context.drawImage(image, 0, 0, canvas.height, canvas.width)\n    } else {\n      context.drawImage(image, 0, 0, canvas.width, canvas.height)\n    }\n    return canvas\n  }\n}\n\nconst canvasToBase64 = (canvas, quality = 0.75) => {\n  // in order to compress the final image format has to be jpeg\n  const base64 = canvas.toDataURL('image/jpeg', quality)\n  return base64\n}\n\n// const canvasToImage = (canvas, quality=.75, mimeType='image/jpeg') => {\n//   const image = new Image()\n//   const base64str = canvas.toDataURL(mimeType, quality)\n//   image.src = base64str\n//   return image\n// }\n\nconst size = (size) => {\n  return {\n    KB: size / 1000,\n    MB: size / (1000 * 1000)\n  }\n}\n\nexport default { base64ToFile, imageToCanvas, canvasToBase64, size }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/converter.js","\nconst load = (file) => {\n  return new Promise((resolve, reject) => {\n    const fileReader = new window.FileReader()\n    fileReader.addEventListener('load', (evt) => {\n      resolve(evt.target.result)\n    }, false)\n\n    fileReader.addEventListener('error', (err) => {\n      reject(err)\n    }, false)\n\n    fileReader.readAsDataURL(file)\n  })\n}\n\nexport default { load }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/file.js","\nconst load = (src) => {\n  return new Promise((resolve, reject) => {\n    const img = new window.Image()\n    img.addEventListener('load', () => {\n      resolve(img)\n    }, false)\n\n    img.addEventListener('error', (err) => {\n      reject(err)\n    }, false)\n\n    img.src = src\n  })\n}\n  /*\n   * Resize the image based on the given height or width boundary.\n   * Auto resize based on aspect ratio.\n  **/\nconst resize = (targetWidth, targetHeight) => {\n  return (width, height) => {\n    if (!targetWidth && !targetHeight) return { width, height }\n\n    const originalAspectRatio = width / height\n    const targetAspectRatio = targetWidth / targetHeight\n\n    let outputWidth, outputHeight\n\n    if (originalAspectRatio > targetAspectRatio) {\n      outputWidth = Math.min(width, targetWidth)\n      outputHeight = outputWidth / originalAspectRatio\n    } else {\n      outputHeight = Math.min(height, targetHeight)\n      outputWidth = outputHeight * originalAspectRatio\n    }\n\n    return { width: outputWidth, height: outputHeight }\n  }\n}\n\nexport default { load, resize }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/image.js","// The photo model\nclass Photo {\n  constructor ({ quality = 0.75, size = 2, maxWidth = 1920, maxHeight = 1920, resize = true }) {\n    this.start = window.performance.now()\n    this.end = null\n\n    this.alt = null\n    this.ext = null\n    this.startSize = null\n    this.startWidth = null\n    this.startHeight = null\n    // How much will the quality decrease by each compression\n    // this.stepQuality = stepQuality\n\n    // size in MB\n    this.size = size * 1000 * 1000\n    this.endSize = null\n    this.endWidth = null\n    this.endHeight = null\n    this.iterations = 0\n    this.base64prefix = null\n    // Carry out image resizing\n    this.quality = quality\n    this.resize = resize\n    this.maxWidth = maxWidth\n    this.maxHeight = maxHeight\n    this.orientation = 1\n  }\n}\nexport default Photo\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/photo.js","// https://stackoverflow.com/questions/20600800/js-client-side-exif-orientation-rotate-and-mirror-jpeg-images/31273162#31273162\n\nconst orientation = (file) => {\n  return new Promise((resolve, reject) => {\n    const reader = new window.FileReader()\n\n    reader.onload = function (event) {\n      var view = new DataView(event.target.result)\n\n      if (view.getUint16(0, false) !== 0xFFD8) {\n        resolve(-2)\n      }\n      const length = view.byteLength\n      let offset = 2\n\n      while (offset < length) {\n        const marker = view.getUint16(offset, false)\n        offset += 2\n\n        if (marker === 0xFFE1) {\n          if (view.getUint32(offset += 2, false) !== 0x45786966) {\n            resolve(-1)\n          }\n          const little = view.getUint16(offset += 6, false) === 0x4949\n          offset += view.getUint32(offset + 4, little)\n          const tags = view.getUint16(offset, little)\n          offset += 2\n\n          for (let i = 0; i < tags; i++) {\n            if (view.getUint16(offset + (i * 12), little) === 0x0112) {\n              resolve(view.getUint16(offset + (i * 12) + 8, little))\n            }\n          }\n        } else if ((marker & 0xFF00) !== 0xFF00) break\n        else offset += view.getUint16(offset, false)\n      }\n      resolve(-1)\n    }\n    reader.readAsArrayBuffer(file.slice(0, 64 * 1024))\n  })\n}\n\nexport default { orientation }\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/rotate.js","import React from 'react'\r\nimport { Link } from \"react-router-dom\"\r\nimport { IUser } from '../../../common/user';\r\nimport { ESize, useImage } from '../../hooks';\r\n\r\ninterface IFollowedUserRow{\r\n    user: IUser;\r\n}\r\n\r\nexport const FollowedUserRow: React.FC<IFollowedUserRow> = ({user}: IFollowedUserRow) => {\r\n    const [imgsrc, onImgError] = useImage(\"/rewer/uploads/avatars\", `${user.userName}.jpg`, ESize.Small);\r\n    return (\r\n        <Link to={`/rewer/user?userName=${user.userName}`}>\r\n            <div className=\"followed-user-row highlight\">\r\n                <img src={imgsrc} onError={onImgError} className=\"followed-user-row-item\" alt=\"user-poster\" />\r\n                <p className=\"followed-user-row-item\">{user.nickName}</p>\r\n            </div>\r\n        </Link>            \r\n    )\r\n}\r\nexport default FollowedUserRow;","/* eslint-disable react-hooks/exhaustive-deps */\r\nimport React, { useState, useEffect, Fragment } from 'react'\r\nimport { postCaller } from '../../callers/caller';\r\nimport { userPath } from '../../callers/userCaller'\r\nimport FollowedUserRow from './FollowedUserRow';\r\n\r\ninterface IFollowedUsers{\r\n    //users: User[];\r\n}\r\n\r\nexport const FollowedUsers: React.FC<IFollowedUsers> = () => {\r\n    const [users, setUsers] = useState([]);\r\n    const [followCaller, signal] = postCaller({userName : localStorage.getItem(\"userName\")}, userPath.selectFollowedUsers);\r\n    useEffect(()=>{\r\n        if(localStorage.getItem(\"userName\")){\r\n            getFollowedUsers();\r\n        }\r\n        return ()=>{\r\n            signal.abort();\r\n        }\r\n    }, []);\r\n\r\n    async function getFollowedUsers(){\r\n        const followed = await followCaller();\r\n        if(followed){\r\n            setUsers(followed);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Fragment>\r\n            <h3 className=\"center-text\">Followed</h3>\r\n            {users.map(u=>{\r\n                return <FollowedUserRow key={`followed-${u.userName}`} user={u} />\r\n            })}\r\n        </Fragment>\r\n    )\r\n}\r\nexport default FollowedUsers;","/* eslint-disable react-hooks/exhaustive-deps */\r\nimport React, { useState, useEffect, Fragment } from 'react'\r\nimport { userPath } from '../../callers/userCaller'\r\nimport FollowedUserRow from './FollowedUserRow';\r\nimport { Link } from \"react-router-dom\";\r\nimport { postCaller } from '../../callers/caller';\r\nimport { IUser } from '../../../common/user';\r\n\r\ninterface IFollowingUsers{\r\n    length: number;\r\n}\r\n\r\nexport const FollowingUsers: React.FC<IFollowingUsers> = ({length}: IFollowingUsers) => {\r\n    const [users, setUsers] = useState<IUser[]>([]);\r\n    const [caller, signal] = postCaller({ userName: localStorage.getItem(\"userName\"), limit: length }, userPath.selectFollowers);\r\n    useEffect(()=>{\r\n        if(localStorage.getItem(\"userName\")){\r\n            getFollowingUsers();\r\n        }\r\n        return ()=>{\r\n            signal.abort();\r\n        }\r\n    }, []);\r\n\r\n    async function getFollowingUsers(){\r\n        const following: IUser[] = await caller();\r\n        if(following){\r\n            setUsers(following);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Fragment>\r\n            <h3 className=\"center-text\">My Followers</h3>\r\n            {users.slice(0, 8).map(u=>{\r\n                return <FollowedUserRow key={`followed-${u.userName}`} user={u} />\r\n            })}\r\n            {users.length > length ?\r\n            (<Link to={\"TODO\"}>More</Link>):\r\n            (<Fragment></Fragment>)}\r\n        </Fragment>\r\n    )\r\n}\r\nexport default FollowingUsers;"],"sourceRoot":""}
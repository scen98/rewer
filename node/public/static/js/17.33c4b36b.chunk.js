(this.webpackJsonprewer=this.webpackJsonprewer||[]).push([[17],{109:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return E}));var a=n(20),r=n(19),c=n(2),i=n.n(c),o=n(3),s=n(12),u=n(0),l=n.n(u),d=(n(30),n(105)),p=n(59),f=n(56),v=n(21),b=n(108),m=n(106),O=n(13),j=n(26);n(58);function E(){var e=Object(f.e)({id:parseInt(Object(v.b)("movieId")),title:"",releaseDate:"",summary:"",runtime:0,casts:[],genres:[]}),t=Object(s.a)(e,3),n=t[0],c=t[1],E=t[2],h=Object(O.postCaller)(),y=Object(s.a)(h,2),w=y[0],x=y[1],g=Object(u.useContext)(j.a).messenger;function k(){return(k=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w({id:n.id},p.b.selectDetailedMovie,O.ECallType.SELECT);case 2:(t=e.sent)?c(t):g.addFail("Server error: could not retireve movie data.");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return(S=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(n,p.b.updateMovie,O.ECallType.ISOK);case 2:if(!e.sent){e.next=6;break}g.addSuccess("Movie details saved.",5e3),e.next=7;break;case 6:g.addFail("Server error: movie details could not be saved.");case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return(C=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(n,p.b.insertMovie,O.ECallType.INSERT);case 2:(t=e.sent)?(c(Object(r.a)(Object(r.a)({},n),{},{id:t})),Object(v.a)({name:"movieId",value:t.toString()}),g.addSuccess("Movie page created.",3e3)):g.addFail("Server error: movie could not be created.");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=Object(o.a)(i.a.mark((function e(t){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={id:0,movieId:n.id,genreId:t.id,genreName:t.name},e.next=3,w(o,p.b.insertMovieGenre,O.ECallType.INSERT);case 3:o.id=e.sent,o.id>0&&c(Object(r.a)(Object(r.a)({},n),{},{genres:[].concat(Object(a.a)(n.genres),[o])}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return(M=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w({id:t},p.b.deleteMovieGenre,O.ECallType.ISOK);case 2:if(!e.sent){e.next=6;break}c(Object(r.a)(Object(r.a)({},n),{},{genres:n.genres.filter((function(e){return e.id!==t}))})),e.next=7;break;case 6:g.addFail("Server error: could not delete genre.");case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(u.useEffect)((function(){return n.id>0&&function(){k.apply(this,arguments)}(),function(){x.abort(),g.clear()}}),[]),Object(u.useEffect)((function(){n&&(document.title="(Edit) ".concat(n.title," - Rewer"))}),[n]),l.a.createElement(u.Fragment,null,l.a.createElement("div",{className:"main-container"},n.id>0?l.a.createElement("button",{onClick:function(){return S.apply(this,arguments)}},"Save"):l.a.createElement("button",{onClick:function(){return C.apply(this,arguments)}},"Create"),l.a.createElement(d.a,{movie:n,setMovie:function(e){c(e)},movieBinder:E}),n.id>0?l.a.createElement(u.Fragment,null,l.a.createElement(m.a,{movie:n,onAdd:function(e){!function(e){I.apply(this,arguments)}(e)},onDelete:function(e){!function(e){M.apply(this,arguments)}(e)}}),l.a.createElement(b.a,{movie:n,setMovie:function(e){c(e)}})):l.a.createElement(u.Fragment,null)))}}}]);
//# sourceMappingURL=17.33c4b36b.chunk.js.map